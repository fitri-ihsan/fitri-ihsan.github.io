<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Undangan Swipe</title>
    
    <style>
        /* --- CSS DASAR --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0; padding: 20px;
            display: flex; justify-content: center; align-items: flex-start;
            min-height: 100vh; color: #333;
            overflow-x: hidden;
            user-select: none; /* Mencegah seleksi teks saat swipe */
        }
        .container {
            background: #ffffff; padding: 30px; border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            width: 100%; max-width: 600px; text-align: center;
            box-sizing: border-box; margin-top: 20px;
            overflow: hidden; 
            position: relative;
        }
        h2 { margin-top: 0; margin-bottom: 5px; color: #222; }
        .subtitle { font-size: 12px; color: #999; margin-bottom: 20px; display: block; }

        /* --- TAB NAVIGATION --- */
        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #eee; position: relative; z-index: 2; }
        .tab-btn {
            flex: 1; padding: 12px; cursor: pointer;
            background: none; border: none; font-weight: 600; color: #888;
            transition: all 0.3s;
        }
        .tab-btn.active { color: #007bff; border-bottom: 2px solid #007bff; }

        /* --- SLIDER CONTAINER --- */
        .tab-window {
            width: 100%;
            overflow: hidden;
            touch-action: pan-y; /* Penting: Izinkan scroll vertikal, blok scroll horizontal browser */
        }
        
        .tab-slider {
            display: flex; 
            width: 200%; 
            transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .tab-panel {
            width: 50%; 
            flex-shrink: 0;
            padding: 5px;
            box-sizing: border-box;
        }

        /* --- FORM ELEMENTS --- */
        .form-group { margin-bottom: 20px; text-align: left; }
        label { display: block; margin-bottom: 8px; font-weight: 600; }
        
        input[type="text"], textarea {
            width: 100%; padding: 12px 15px; font-size: 14px;
            border: 1px solid #ddd; border-radius: 8px;
            box-sizing: border-box; font-family: inherit;
            user-select: text; /* Izinkan teks input dipilih */
        }
        textarea#bulkInput { height: 100px; }

        /* --- TOMBOL --- */
        button {
            width: 100%; padding: 12px 20px; font-size: 15px; font-weight: bold;
            border: none; border-radius: 8px; cursor: pointer;
            transition: all 0.2s; color: white;
        }
        .btn-primary { background-color: #007bff; margin-bottom: 15px; }
        .btn-primary:hover { background-color: #0056b3; }
        
        .action-row { display: flex; gap: 10px; margin-top: 10px; }
        .action-row button { margin-bottom: 0; flex: 1; }

        .btn-success { background-color: #25D366; }
        .btn-success:hover { background-color: #1EAE57; }

        .btn-secondary { background-color: #6c757d; }
        .btn-secondary:hover { background-color: #5a6268; }

        .btn-copy-sm { background-color: #f1f3f5; color: #333; border: 1px solid #ddd; }
        .btn-copy-sm:hover { background-color: #e9ecef; }

        /* --- LIST HASIL --- */
        #bulkListOutput {
            margin-top: 20px; text-align: left;
            max-height: 400px; overflow-y: auto;
            border: 1px solid #eee; padding: 10px; border-radius: 8px;
        }
        .result-card {
            background: #fff; border: 1px solid #e0e0e0;
            border-radius: 8px; padding: 15px; margin-bottom: 10px;
            display: flex; flex-direction: column; gap: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .result-info strong { color: #333; font-size: 1.1em; display: block; }
        .result-info small { color: #007bff; word-break: break-all; }

        /* --- CUSTOM ALERT --- */
        .aesthetic-alert-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4); backdrop-filter: blur(5px);
            z-index: 9999; display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden; transition: all 0.3s;
        }
        .aesthetic-alert-overlay.active { opacity: 1; visibility: visible; }
        .aesthetic-alert-box {
            background: white; padding: 25px; border-radius: 20px; width: 80%; max-width: 320px;
            text-align: center; transform: scale(0.8); transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .aesthetic-alert-overlay.active .aesthetic-alert-box { transform: scale(1); }
        .alert-btn { background: #007bff; color: white; padding: 10px 25px; border-radius: 50px; margin-top: 15px; display: inline-block; width: auto; }
    </style>
</head>
<body>

    <div class="container">
        <h2>Generator Undangan</h2>
        <span class="subtitle">Swipe kiri/kanan untuk pindah menu</span>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('single')">Satuan</button>
            <button class="tab-btn" onclick="switchTab('bulk')">Massal</button>
        </div>

        <div class="tab-window" id="swipeArea">
            <div class="tab-slider" id="tabSlider">
                
                <div class="tab-panel">
                    <div class="form-group">
                        <label>Nama Tamu:</label>
                        <input type="text" id="namaInput" placeholder="Contoh: Afnan Al Fatih">
                    </div>
                    
                    <button class="btn-primary" id="buatLinkBtn">Buat Link</button>
                    
                    <div id="hasilLink" style="margin: 15px 0; padding:10px; background:#f8f9fa; border-radius:5px; word-break:break-all; min-height: 1.2em;">Link muncul di sini...</div>
                    
                    <div class="action-row">
                        <button class="btn-success" id="kirimWaBtn">Kirim WA</button>
                        <button class="btn-copy-sm" id="copyMessageSingleBtn">Salin Pesan</button>
                    </div>
                </div>

                <div class="tab-panel">
                    <div class="form-group">
                        <label>Input Daftar Nama (Satu nama per baris):</label>
                        <textarea id="bulkInput" placeholder="Bowo Subianti&#10;Bahlul Lahadidi&#10;Jorok Widodo"></textarea>
                    </div>
                    <button class="btn-primary" id="bulkGenerateBtn">Generate Daftar Tamu</button>
                    
                    <div id="bulkListOutput">
                        <p style="text-align:center; color:#999;">Link akan muncul di sini...</p>
                    </div>
                    
                    <div style="margin-top:20px;">
                        <textarea id="bulkResultText" readonly style="height:60px; font-size:11px; color:#777; width:100%; border:1px solid #eee; border-radius:5px;"></textarea>
                        <button class="btn-secondary btn-sm" id="copyBulkBtn" style="width:100%; margin-top:5px; padding:8px;">Salin Semua Link Mentah</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="custom-alert" class="aesthetic-alert-overlay">
        <div class="aesthetic-alert-box">
            <h3 style="margin:0 0 10px;">Notifikasi</h3>
            <p id="alert-msg" style="color:#666;">Pesan</p>
            <button class="alert-btn" onclick="document.getElementById('custom-alert').classList.remove('active')">OK</button>
        </div>
    </div>

    <script>
        const baseURL = "https://fitri-ihsan.github.io/fi/?";

        // --- FUNGSI SLIDE & SWIPE ---
        let currentTab = 'single'; // Melacak posisi saat ini

        function switchTab(mode) {
            const slider = document.getElementById('tabSlider');
            const btns = document.querySelectorAll('.tab-btn');

            btns.forEach(btn => btn.classList.remove('active'));

            if(mode === 'single') {
                btns[0].classList.add('active');
                slider.style.transform = 'translateX(0)';
                currentTab = 'single';
            } else {
                btns[1].classList.add('active');
                slider.style.transform = 'translateX(-50%)';
                currentTab = 'bulk';
            }
        }

        // --- LOGIKA SENTUH / SWIPE ---
        document.addEventListener("DOMContentLoaded", function() {
            const swipeArea = document.getElementById('swipeArea');
            let touchStartX = 0;
            let touchEndX = 0;
            let minSwipeDistance = 50; // Jarak minimal usapan agar dihitung swipe

            swipeArea.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].screenX;
            }, {passive: true});

            swipeArea.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, {passive: true});

            function handleSwipe() {
                const distance = touchStartX - touchEndX;

                // Jika jarak swipe cukup jauh
                if (Math.abs(distance) > minSwipeDistance) {
                    // Swipe ke KIRI (Jari bergerak dari kanan ke kiri)
                    // Artinya user ingin melihat konten di SEBELAH KANAN
                    if (distance > 0 && currentTab === 'single') {
                        switchTab('bulk');
                    }
                    
                    // Swipe ke KANAN (Jari bergerak dari kiri ke kanan)
                    // Artinya user ingin melihat konten di SEBELAH KIRI
                    if (distance < 0 && currentTab === 'bulk') {
                        switchTab('single');
                    }
                }
            }

            // --- KODE LAMA (LOGIKA TOMBOL & GENERATOR) ---
            
            // LOGIKA TAB 1: SATUAN
            const namaInput = document.getElementById("namaInput");
            const hasilLink = document.getElementById("hasilLink");

            document.getElementById("buatLinkBtn").addEventListener("click", function() {
                const nama = namaInput.value.trim();
                if (!nama) { showAlert("Masukkan nama tamu dulu!"); return; }
                const link = baseURL + encodeURIComponent(nama).replace(/%20/g, '+');
                hasilLink.textContent = link;
                hasilLink.style.color = "#000";
            });

            document.getElementById("kirimWaBtn").addEventListener("click", function() {
                const nama = namaInput.value.trim();
                const link = hasilLink.textContent;
                if (!nama || link.includes("Link muncul")) { showAlert("Klik 'Buat Link' dulu!"); return; }
                const msg = generateWhatsAppMessage(nama, link);
                window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, "_blank");
            });

            document.getElementById("copyMessageSingleBtn").addEventListener("click", function() {
                const nama = namaInput.value.trim();
                const link = hasilLink.textContent;
                if (!nama || link.includes("Link muncul")) { showAlert("Klik 'Buat Link' dulu!"); return; }
                const msg = generateWhatsAppMessage(nama, link);
                copyToClipboard(msg, "Pesan WA berhasil disalin!");
            });

            // LOGIKA TAB 2: MASSAL
            const bulkInput = document.getElementById("bulkInput");
            const bulkListOutput = document.getElementById("bulkListOutput");
            const bulkResultText = document.getElementById("bulkResultText");

            document.getElementById("bulkGenerateBtn").addEventListener("click", function() {
                const rawText = bulkInput.value;
                if (!rawText.trim()) { showAlert("Input daftar nama dulu!"); return; }

                const names = rawText.split('\n');
                let listHTML = "";
                let rawLinks = "";
                let count = 0;

                names.forEach(name => {
                    const cleanName = name.trim();
                    if (cleanName) {
                        const linkUrl = baseURL + encodeURIComponent(cleanName).replace(/%20/g, '+');
                        const waMessage = generateWhatsAppMessage(cleanName, linkUrl);
                        const safeMsgEncoded = encodeURIComponent(waMessage);
                        const waLink = `https://wa.me/?text=${safeMsgEncoded}`;

                        listHTML += `
                        <div class="result-card">
                            <div class="result-info">
                                <strong>${cleanName}</strong>
                                <small>${linkUrl}</small>
                            </div>
                            <div class="action-row">
                                <a href="${waLink}" target="_blank" class="btn-success btn-sm" style="text-decoration:none; text-align:center; line-height:30px; display:block; flex:1; border-radius:8px; color:white; font-weight:bold; font-size:13px;">
                                    &#128241; Kirim WA
                                </a>
                                <button class="btn-copy-sm btn-sm" onclick="copyFullMessage('${safeMsgEncoded}')" style="flex:1;">
                                    Salin Pesan
                                </button>
                            </div>
                        </div>`;
                        rawLinks += `${linkUrl}\n`;
                        count++;
                    }
                });

                bulkListOutput.innerHTML = listHTML;
                bulkResultText.value = rawLinks;
                if (count > 0) showAlert(`Berhasil membuat ${count} undangan!`);
            });
            
            document.getElementById("copyBulkBtn").addEventListener("click", function() {
                if(!bulkResultText.value) return;
                copyToClipboard(bulkResultText.value, "Semua link mentah tersalin!");
            });
        });

        // --- HELPER FUNCTIONS ---
        function generateWhatsAppMessage(namaAsli, linkLengkap) {
            return `Kepada Yth.\nBapak/Ibu/Saudara(i)\n*${namaAsli}*\n--------------------\n\n*Assalamualaikum Warahmatullahi Wabarakatuh*\n\nTanpa mengurangi rasa hormat perkenankan kami mengundang Bapak/Ibu/Saudara(i) ${namaAsli} untuk menghadiri acara pernikahan kami.\n\n*Nurfitriani & Syukur Al Ihsan*\n\nBerikut Link Undangan kami:\n${linkLengkap}\n\nMerupakan suatu kebahagiaan bagi kami apabila Bapak/Ibu/Saudara(i) ${namaAsli} berkenan untuk hadir dan memberikan doa restu.\nTerima kasih.\n\n*Wassalamualaikum Warahmatullahi Wabarakatuh*`;
        }

        function showAlert(msg) {
            document.getElementById('alert-msg').innerText = msg;
            document.getElementById('custom-alert').classList.add('active');
        }

        function copyToClipboard(text, successMsg) {
            navigator.clipboard.writeText(text).then(() => showAlert(successMsg))
            .catch(err => { console.error(err); showAlert("Gagal menyalin."); });
        }

        function copyFullMessage(encodedMsg) {
            const fullMessage = decodeURIComponent(encodedMsg);
            copyToClipboard(fullMessage, "Pesan lengkap berhasil disalin!");
        }
    </script>
</body>
</html>
